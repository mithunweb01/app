<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mithun Multi-Tool App</title>

<!-- External Libraries -->
<script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.6/dist/JsBarcode.all.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/algebrite@1.3.1/dist/algebrite.min.js"></script>

<style>
:root {
  --bg1: #ff5f6d;
  --bg2: #ffc371;
  --card: rgba(255,255,255,0.95);
  --text-dark: #000;
  --accent: #2196F3;
}
body {
  margin:0;
  background:linear-gradient(135deg,var(--bg1),var(--bg2));
  font-family:Arial, sans-serif;
  color:white;
}

/* Tabs */
.tabs{
  display:flex;
  gap:10px;
  padding:12px;
  justify-content:center;
  background:rgba(0,0,0,0.4);
  position:sticky;
  top:0;
  z-index:1000;
}
.tab-btn{
  padding:10px 15px;
  border-radius:12px;
  background:rgba(255,255,255,0.2);
  color:white;
  cursor:pointer;
  font-weight:bold;
  border:2px solid var(--accent);
}
.tab-btn:hover, .tab-btn.active-tab{
  background:var(--accent);
}

/* Content */
.tab-content{ display:none; padding:20px; }
.active{ display:block; }

.tool-box{
  background:var(--card);
  color:var(--text-dark);
  padding:15px;
  border-radius:12px;
  margin-bottom:20px;
  box-shadow:0 8px 20px rgba(0,0,0,0.3);
}

input,textarea,select,button{
  padding:10px;
  margin:5px;
  border-radius:8px;
  border:1px solid #ccc;
}
button{
  background:var(--accent);
  color:white;
  cursor:pointer;
  font-weight:bold;
}
.result{
  background:#f0f8ff;
  padding:10px;
  border-radius:10px;
  margin-top:10px;
  border-left:5px solid var(--accent);
  white-space:pre-wrap;
}

/* Life Tools Sub-tab Buttons */
.life-grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(150px,1fr));
  gap:15px;
}
.life-btn{
  background:white;
  color:black;
  padding:15px;
  border-radius:12px;
  text-align:center;
  cursor:pointer;
  font-weight:bold;
  border:2px solid var(--accent);
}
.life-btn:hover{
  background:var(--accent);
  color:white;
}

/* Hidden sub-pages */
.life-subtab{ display:none; }
.life-subtab.active-sub{ display:block; }

.flag-img{
  width:120px; border-radius:10px; margin-top:10px;
}
</style>

</head>
<body>

<div class="tabs">
  <div class="tab-btn" onclick="openTab('home',this)">Home</div>
  <div class="tab-btn" onclick="openTab('smart',this)">Smart Tools</div>
  <div class="tab-btn" onclick="openTab('capital',this)">Capital Finder</div>
  <div class="tab-btn" onclick="openTab('algebra',this)">Algebra Solver</div>
  <div class="tab-btn" onclick="openTab('operations',this)">Operations</div>
  <div class="tab-btn" onclick="openTab('life',this)">Life Tools</div>
  <div class="tab-btn" onclick="openTab('weather',this)">Weather</div>
  <div class="tab-btn" onclick="openTab('quiz',this)">Quiz</div>
</div>

<!-- HOME -->
<div id="home" class="tab-content">
  <h1>Welcome Mithun ðŸ‘‹</h1>
  <div class="tool-box">
    <h3>Text Tools</h3>
    <textarea id="text_in"></textarea>
    <button onclick="upperText()">UPPERCASE</button>
    <button onclick="lowerText()">lowercase</button>
    <button onclick="removeSpaces()">Remove Spaces</button>
    <textarea id="text_out" class="result"></textarea>
  </div>
</div>

<!-- SMART TOOLS -->
<div id="smart" class="tab-content">
  <h2>Smart Tools</h2>

  <div class="tool-box">
    <h3>QR Code</h3>
    <input id="qr_text">
    <button onclick="makeQR()">Generate</button>
    <div id="qr_box" class="result"></div>
  </div>

  <div class="tool-box">
    <h3>Barcode</h3>
    <input id="barcode_text">
    <button onclick="makeBarcode()">Generate</button>
    <svg id="barcode_svg"></svg>
  </div>

  <div class="tool-box">
    <h3>Your IP</h3>
    <button onclick="getIP()">Show IP</button>
    <div id="ip_box" class="result"></div>
  </div>

  <div class="tool-box">
    <h3>Device Info</h3>
    <button onclick="getDeviceInfo()">Show</button>
    <div id="device_box" class="result"></div>
  </div>

  <div class="tool-box">
    <h3>Password Strength</h3>
    <input id="pwd_input">
    <button onclick="checkPwd()">Check</button>
    <div id="pwd_box" class="result"></div>
  </div>

</div>

<!-- CAPITAL FINDER -->
<div id="capital" class="tab-content">
  <h2>Capital Finder</h2>

  <div class="tool-box">
    <input id="country_in" placeholder="Enter country">
    <button onclick="findCapital()">Find</button>
    <div id="capital_out" class="result"></div>
  </div>
</div>

<!-- LIFE TOOLS -->
<div id="life" class="tab-content">
  <h2>Life Tools</h2>

  <div class="life-grid">
    <div class="life-btn" onclick="openLife('age')">Age</div>
    <div class="life-btn" onclick="openLife('bmi')">BMI</div>
    <div class="life-btn" onclick="openLife('emi')">EMI</div>
    <div class="life-btn" onclick="openLife('unit')">Unit Convert</div>
    <div class="life-btn" onclick="openLife('square')">Square/Cube Root</div>
    <div class="life-btn" onclick="openLife('percent')">Percentage</div>
    <div class="life-btn" onclick="openLife('discount')">Discount</div>
  </div>

  <!-- AGE -->
  <div id="age" class="life-subtab">
    <div class="tool-box">
      <h3>Age Calculator</h3>
      <input type="date" id="age_dob">
      <button onclick="calcAge()">Calculate</button>
      <div id="age_out" class="result"></div>
    </div>
  </div>

  <!-- BMI -->
  <div id="bmi" class="life-subtab">
    <div class="tool-box">
      <h3>BMI Calculator</h3>
      <input id="bmi_h" placeholder="Height (cm)">
      <input id="bmi_w" placeholder="Weight (kg)">
      <button onclick="calcBMI()">Calculate</button>
      <div id="bmi_out" class="result"></div>
    </div>
  </div>

  <!-- EMI -->
  <div id="emi" class="life-subtab">
    <div class="tool-box">
      <h3>EMI Calculator</h3>
      <input id="emi_p" placeholder="Principal">
      <input id="emi_r" placeholder="Rate %">
      <input id="emi_n" placeholder="Months">
      <button onclick="calcEMI()">Calculate</button>
      <div id="emi_out" class="result"></div>
    </div>
  </div>

  <!-- UNIT CONVERT -->
  <div id="unit" class="life-subtab">
    <div class="tool-box">
      <h3>Unit Convert (m â†” cm)</h3>
      <input id="unit_in">
      <select id="unit_type">
        <option value="m-cm">Meter â†’ CM</option>
        <option value="cm-m">CM â†’ Meter</option>
      </select>
      <button onclick="convertUnit()">Convert</button>
      <div id="unit_out" class="result"></div>
    </div>
  </div>

  <!-- SQUARE ROOT / CUBE ROOT -->
  <div id="square" class="life-subtab">
    <div class="tool-box">
      <h3>Square / Cube Root</h3>
      <input id="root_in">
      <button onclick="calcRoot()">Calculate</button>
      <div id="root_out" class="result"></div>
    </div>
  </div>

  <!-- PERCENTAGE -->
  <div id="percent" class="life-subtab">
    <div class="tool-box">
      <h3>Percentage Finder</h3>
      <input id="percent_a" placeholder="Value">
      <input id="percent_b" placeholder="Total">
      <button onclick="calcPercent()">Find</button>
      <div id="percent_out" class="result"></div>
    </div>
  </div>

</div>

<!-- WEATHER -->
<div id="weather" class="tab-content">
  <h2>Weather</h2>

  <div class="tool-box">
    <h3>Auto Location</h3>
    <button onclick="autoWeather()">Get Weather</button>
    <div id="auto_weather_out" class="result"></div>
  </div>

  <div class="tool-box">
    <h3>City Search</h3>
    <input id="city_in">
    <button onclick="cityWeather()">Search</button>
    <div id="city_weather_out" class="result"></div>
  </div>
</div>

<!-- PART 2 (JS FUNCTIONS) WILL COME NEXT -->
<script>
// ---------------------- SHOW SECTIONS -----------------------
function showSection(id) {
  document.querySelectorAll(".section").forEach(s => s.style.display = "none");
  document.getElementById(id).style.display = "block";
}

// ---------------------- LIFE TOOLS SUB-PAGES -----------------------
function showLife(tool) {
  let html = "";

  if (tool === "ageTool") {
    html = `
      <div class="tool-card">
        <h3>Age Calculator</h3>
        <input type="date" id="dob">
        <button class="action" onclick="calcAge()">Calculate</button>
        <div id="ageResult" class="result-box"></div>
      </div>`;
  }

  if (tool === "bmiTool") {
    html = `
      <div class="tool-card">
        <h3>BMI Calculator</h3>
        <input type="number" id="height" placeholder="Height in cm">
        <input type="number" id="weight" placeholder="Weight in kg">
        <button class="action" onclick="calcBMI()">Calculate</button>
        <div id="bmiResult" class="result-box"></div>
      </div>`;
  }

  if (tool === "emiTool") {
    html = `
      <div class="tool-card">
        <h3>EMI Calculator</h3>
        <input type="number" id="loan" placeholder="Loan Amount">
        <input type="number" id="rate" placeholder="Interest (%)">
        <input type="number" id="months" placeholder="Months">
        <button class="action" onclick="calcEMI()">Calculate</button>
        <div id="emiResult" class="result-box"></div>
      </div>`;
  }

  if (tool === "unitTool") {
    html = `
      <div class="tool-card">
        <h3>Unit Converter (km â†” miles)</h3>
        <input type="number" id="km" placeholder="Kilometers">
        <button class="action" onclick="kmToMiles()">Convert</button>
        <div id="unitResult" class="result-box"></div>
      </div>`;
  }

  if (tool === "expenseTool") {
    html = `
      <div class="tool-card">
        <h3>Expense Tracker</h3>
        <input type="text" id="expName" placeholder="Item">
        <input type="number" id="expAmt" placeholder="Amount">
        <button class="action" onclick="addExpense()">Add</button>
        <div id="expList" class="result-box"></div>
      </div>`;
  }

  if (tool === "passGenTool") {
    html = `
      <div class="tool-card">
        <h3>Password Generator</h3>
        <input type="number" id="passLen" placeholder="Length (8â€“20)">
        <button class="action" onclick="genPassword()">Generate</button>
        <div id="genPassResult" class="result-box"></div>
      </div>`;
  }

  if (tool === "rootTool") {
    html = `
      <div class="tool-card">
        <h3>Square & Cube Root Finder</h3>
        <input type="number" id="rootNum" placeholder="Enter number">
        <button class="action" onclick="calcRoots()">Calculate</button>
        <div id="rootResult" class="result-box"></div>
      </div>`;
  }

  document.getElementById("lifeContent").innerHTML = html;
}

// ---------------------- LIFE TOOL FUNCTIONS -----------------------
function calcAge() {
  let dob = new Date(document.getElementById("dob").value);
  let diff = Date.now() - dob.getTime();
  let age = new Date(diff).getUTCFullYear() - 1970;
  document.getElementById("ageResult").innerHTML = "Age: " + age;
}

function calcBMI() {
  let h = document.getElementById("height").value / 100;
  let w = document.getElementById("weight").value;
  let bmi = (w / (h * h)).toFixed(2);
  document.getElementById("bmiResult").innerHTML = "BMI: " + bmi;
}

function calcEMI() {
  let P = document.getElementById("loan").value;
  let R = document.getElementById("rate").value / 1200;
  let N = document.getElementById("months").value;

  let emi = P * R * (Math.pow(1 + R, N)) / (Math.pow(1 + R, N) - 1);
  document.getElementById("emiResult").innerHTML = "EMI: â‚¹" + emi.toFixed(2);
}

function kmToMiles() {
  let km = document.getElementById("km").value;
  document.getElementById("unitResult").innerHTML =
    `${km} km = ${(km * 0.621371).toFixed(2)} miles`;
}

let expenses = [];
function addExpense() {
  let name = document.getElementById("expName").value;
  let amt = Number(document.getElementById("expAmt").value);
  expenses.push({ name, amt });

  let html = expenses.map(e => `${e.name}: â‚¹${e.amt}`).join("<br>");
  document.getElementById("expList").innerHTML = html;
}

function genPassword() {
  let len = document.getElementById("passLen").value;
  let chars = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789@#$%";
  let pass = "";
  for (let i = 0; i < len; i++) pass += chars[Math.floor(Math.random() * chars.length)];

  document.getElementById("genPassResult").innerHTML = pass;
}

function calcRoots() {
  let n = document.getElementById("rootNum").value;
  document.getElementById("rootResult").innerHTML =
    `Square Root: ${Math.sqrt(n).toFixed(4)}<br>Cube Root: ${Math.cbrt(n).toFixed(4)}`;
}

// ---------------------- SMART TOOLS -----------------------
function generateQR() {
  let t = document.getElementById("qrInput").value;
  document.getElementById("qrOutput").innerHTML =
    `<img src="https://api.qrserver.com/v1/create-qr-code/?size=150x150&data=${t}">`;
}

function generateBarcode() {
  let val = document.getElementById("barcodeInput").value;
  JsBarcode("#barcodeOutput", val);
}

async function findIP() {
  let data = await fetch("https://api.ipify.org?format=json").then(r => r.json());
  document.getElementById("ipResult").innerHTML = "Your IP: " + data.ip;
}

function deviceInfo() {
  let ua = navigator.userAgent;
  document.getElementById("deviceResult").innerHTML = ua;
}

function checkPassword() {
  let p = document.getElementById("passCheck").value;
  let score = 0;
  if (p.length >= 8) score++;
  if (/[0-9]/.test(p)) score++;
  if (/[A-Z]/.test(p)) score++;
  if (/[@#$%]/.test(p)) score++;

  let msg = ["Very Weak", "Weak", "Good", "Strong", "Very Strong"][score];
  document.getElementById("passResult").innerHTML = "Strength: " + msg;
}

// ---------------------- WEATHER -----------------------
async function getWeather() {
  let c = document.getElementById("cityWeather").value;
  let url = `https://api.openweathermap.org/data/2.5/weather?q=${c}&appid=439d4b804bc8187953eb36d2a8c26a02&units=metric`;

  let d = await fetch(url).then(r => r.json());
  if (!d.main) {
    document.getElementById("weatherResult").innerHTML = "City not found.";
    return;
  }

  document.getElementById("weatherResult").innerHTML =
    `Temp: ${d.main.temp}Â°C<br>Humidity: ${d.main.humidity}%<br>Weather: ${d.weather[0].description}`;
}

function autoWeather() {
  navigator.geolocation.getCurrentPosition(async pos => {
    let lat = pos.coords.latitude;
    let lon = pos.coords.longitude;

    let url = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=439d4b804bc8187953eb36d2a8c26a02&units=metric`;
    let d = await fetch(url).then(r => r.json());

    document.getElementById("weatherResult").innerHTML =
      `Location: ${d.name}<br>Temp: ${d.main.temp}Â°C<br>Weather: ${d.weather[0].description}`;
  });
}
/* ---------------------- CAPITAL FINDER ----------------------- */

// Fuzzy matching function (basic)
function fuzzyMatch(input, list) {
  input = input.toLowerCase();
  let best = "";
  let score = 999;

  for (let country of list) {
    let c = country.toLowerCase();
    let dist = levenshtein(input, c);
    if (dist < score) {
      score = dist;
      best = country;
    }
  }
  return best;
}

// Levenshtein Distance (for fuzzy)
function levenshtein(a, b) {
  const matrix = Array(a.length + 1).fill(null).map(() =>
    Array(b.length + 1).fill(null)
  );

  for (let i = 0; i <= a.length; i++) matrix[i][0] = i;
  for (let j = 0; j <= b.length; j++) matrix[0][j] = j;

  for (let i = 1; i <= a.length; i++) {
    for (let j = 1; j <= b.length; j++) {
      const cost = a[i - 1] === b[j - 1] ? 0 : 1;
      matrix[i][j] = Math.min(
        matrix[i - 1][j] + 1,
        matrix[i][j - 1] + 1,
        matrix[i - 1][j - 1] + cost
      );
    }
  }
  return matrix[a.length][b.length];
}

async function getCapital() {
  const input = document.getElementById("countryInput").value;

  // Get all country names for fuzzy matching
  let all = await fetch("https://restcountries.com/v3.1/all").then(r => r.json());
  let names = all.map(c => c.name.common);

  let bestMatch = fuzzyMatch(input, names);

  // Fetch best match info
  let url = `https://restcountries.com/v3.1/name/${bestMatch}?fullText=true`;
  let data = await fetch(url).then(r => r.json());
  let c = data[0];

  let name = c.name.common;
  let capital = c.capital ? c.capital[0] : "No capital";
  let region = c.region;
  let population = c.population.toLocaleString();
  let flag = c.flags.png;

  let languages = c.languages ? Object.values(c.languages).join(", ") : "N/A";
  let currencies = c.currencies ?
    Object.values(c.currencies).map(x => x.name).join(", ")
    : "N/A";

  // Wikipedia short summary API
  let wikiURL = `https://en.wikipedia.org/api/rest_v1/page/summary/${name}`;
  let wiki = await fetch(wikiURL).then(r => r.json());

  let summary = wiki.extract ? wiki.extract : "No summary available.";

  document.getElementById("capitalResult").innerHTML = `
    <h3>${name}</h3>
    <img src="${flag}" width="120">
    <p><b>Capital:</b> ${capital}</p>
    <p><b>Region:</b> ${region}</p>
    <p><b>Population:</b> ${population}</p>
    <p><b>Languages:</b> ${languages}</p>
    <p><b>Currencies:</b> ${currencies}</p>
    <hr>
    <p><b>About ${name}:</b><br>${summary}</p>
  `;
}

</script>

<script src="https://cdn.jsdelivr.net/jsbarcode/3.11.5/JsBarcode.all.min.js"></script>

</body>
</html>
