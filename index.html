<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <meta name="google-adsense-account" content="ca-pub-1195321182602348">
  <meta name="google-site-verification" content="YUqkf7c7YEs8IuaoGH_YEbtAlTwlNHAr_Oj2RhOhdmE" />
  <meta name="description" content="Mithun Tools - 70+ Free Online Tools - UPI QR, GST Invoice, Gold Rate, Live Cricket, Income Tax | Made in India by Mithun"/>
  <title>Mithun Tools - 70+ Free Online Tools (Made in India)</title>

  <!-- Libraries -->
  <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.6/dist/JsBarcode.all.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjs@12.0.0/lib/browser/math.min.js"></script>

  <style>
    :root{
      --bg1:#ff5f6d;--bg2:#ffc371;--accent:#ff4d79;--glass:rgba(255,255,255,0.18);
      --glass-border:rgba(255,255,255,0.25);--shadow:rgba(0,0,0,0.18);--text:#111;
    }
    [data-theme="dark"]{
      --bg1:#0f0f1e;--bg2:#1a1a2e;--accent:#ff3366;--glass:rgba(0,0,0,0.4);
      --glass-border:rgba(255,255,255,0.1);--text:#fff;--shadow:rgba(0,0,0,0.5);
    }

    *, *::before, *::after { box-sizing: border-box; }

    body {
      margin: 0; padding: 0; min-height: 100vh;
      font-family: Arial, Helvetica, sans-serif;
      background: linear-gradient(135deg, var(--bg1), var(--bg2));
      color: var(--text);
      line-height: 1.5;
    }

    .tabs{position:sticky;top:0;z-index:1000;display:flex;gap:8px;padding:10px;overflow-x:auto;
      background:rgba(0,0,0,0.25);backdrop-filter:blur(6px);}
    .tab-btn{flex:0 0 auto;padding:10px 14px;border-radius:14px;background:var(--glass);
      border:1px solid var(--glass-border);cursor:pointer;font-weight:700;color:#fff;white-space:nowrap;transition:0.3s;}
    .tab-btn:hover{transform:translateY(-2px)}
    .tab-btn.active-tab{background:var(--accent);}

    .container{padding:16px;max-width:1100px;margin:0 auto;}
    .tab-content{display:none;padding:10px 0;}
    .tab-content.active{display:block;}

    .tool-box{background:var(--glass);border:1px solid var(--glass-border);
      padding:14px;border-radius:14px;margin-bottom:16px;box-shadow:0 8px 20px var(--shadow);color:var(--text);backdrop-filter:blur(10px);}

    input,select,textarea,button{
      padding:10px;border-radius:8px;border:1px solid rgba(0,0,0,0.12);
      margin-top:8px;width:100%;font-size:15px;background:#fff;color:#000;}
    button{background:var(--accent);color:white;border:none;cursor:pointer;font-weight:bold;}
    button:hover{opacity:0.9;}
    textarea{min-height:100px;resize:vertical;}
    .result{background:#fff;color:#000;border-radius:10px;padding:10px;margin-top:10px;
      white-space:pre-wrap;border-left:4px solid var(--accent);}

    .tools-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:14px;margin-top:12px;}
    .life-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(120px,1fr));gap:10px;}
    .life-btn{background:rgba(255,255,255,0.12);border:1px solid var(--glass-border);
      padding:14px;border-radius:12px;text-align:center;cursor:pointer;font-weight:700;color:#fff;transition:0.3s;}
    .life-btn:hover{background:var(--accent);}

    .theme-toggle{position:fixed;bottom:20px;right:20px;background:var(--accent);color:white;
      width:60px;height:60px;border-radius:50%;display:flex;align-items:center;justify-content:center;
      font-size:28px;cursor:pointer;z-index:1000;box-shadow:0 4px 20px rgba(0,0,0,0.4);}

    .copy-btn{background:#28a745;color:white;padding:8px 16px;margin-top:10px;border:none;border-radius:8px;cursor:pointer;}
    .disclaimer{font-size:12px;color:#888;margin-top:8px;}

    @media (max-width:600px){
      .tab-btn{padding:8px 10px;font-size:13px;}
      .tool-box{padding:12px;}
    }
    .hidden{display:none}
  </style>
</head>
<body>

<div class="tabs">
  <button class="tab-btn active-tab" data-tab="home" onclick="openTab('home',this)">Home</button>
  <button class="tab-btn" data-tab="smart" onclick="openTab('smart',this)">Smart Tools</button>
  <button class="tab-btn" data-tab="life" onclick="openTab('life',this)">Life Tools</button>
  <button class="tab-btn" data-tab="india" onclick="openTab('india',this)">India Tools</button>
  <button class="tab-btn" data-tab="finance" onclick="openTab('finance',this)">Finance & Tax</button>
  <button class="tab-btn" data-tab="fun" onclick="openTab('fun',this)">Fun & Viral</button>
  <button class="tab-btn" data-tab="number" onclick="openTab('number',this)">Number Tools</button>
  <button class="tab-btn" data-tab="operations" onclick="openTab('operations',this)">Operations</button>
  <button class="tab-btn" data-tab="weather" onclick="openTab('weather',this)">Weather</button>
</div>

<div class="container">

  <!-- HOME -->
  <section id="home" class="tab-content active">
    <h1 style="text-align:center;font-size:2.5em;margin:20px 0;color:white">Mithun Tools</h1>
    <p style="text-align:center;color:white;font-size:1.3em">70+ Free Online Tools • Made in India • No Ads • Works Offline</p>
    <div class="tool-box">
      <h3>Text Tools</h3>
      <textarea id="text_in" placeholder="Type or paste text here..."></textarea>
      <div style="display:flex;gap:8px;margin-top:8px;flex-wrap:wrap">
        <button onclick="upperText()">UPPERCASE</button>
        <button onclick="lowerText()">lowercase</button>
        <button onclick="removeSpaces()">Remove Spaces</button>
        <button onclick="copyResult()">Copy Result</button>
      </div>
      <textarea id="text_out" class="result" readonly placeholder="Result will appear here"></textarea>
    </div>
  </section>

  <!-- SMART TOOLS -->
  <section id="smart" class="tab-content">
    <h2 style="color:white">Smart Tools</h2>
    <div class="tools-grid">

      <div class="tool-box">
        <h3>QR Code</h3>
        <input id="qr_text" placeholder="Text or URL for QR">
        <button onclick="makeQR()">Generate</button>
        <div id="qr_box" class="result" style="text-align:center"></div>
      </div>

      <div class="tool-box">
        <h3>Barcode</h3>
        <input id="barcode_text" placeholder="Enter numbers/text for barcode">
        <button onclick="makeBarcode()">Generate</button>
        <div class="result" style="text-align:center"><svg id="barcode_svg"></svg></div>
      </div>

      <div class="tool-box">
        <h3>Your IP</h3>
        <button onclick="getIP()">Show IP</button>
        <div id="ip_box" class="result"></div>
      </div>

      <div class="tool-box">
        <h3>Device Info</h3>
        <button onclick="getDeviceInfo()">Show</button>
        <div id="device_box" class="result"></div>
      </div>

      <div class="tool-box">
        <h3>Password Strength</h3>
        <input id="pwd_input" type="password" placeholder="Enter password">
        <button onclick="checkPwd()">Check</button>
        <div id="pwd_box" class="result"></div>
      </div>

      <div class="tool-box">
        <h3>URL Shortener</h3>
        <input id="long_url" placeholder="Enter long URL">
        <button onclick="shortenURL()">Shorten</button>
        <div id="short_url" class="result"></div>
      </div>

      <div class="tool-box">
        <h3>Text to PDF</h3>
        <textarea id="pdf_text" placeholder="Enter text to convert to PDF"></textarea>
        <button onclick="textToPDF()">Download PDF</button>
      </div>

      <div class="tool-box">
        <h3>Voice-to-Text (Browser API)</h3>
        <button id="start_voice" onclick="toggleVoice()">Start Recording</button>
        <button id="stop_voice" style="display:none;background:#c00" onclick="toggleVoice()">Stop Recording</button>
        <div id="voice_result" class="result"></div>
      </div>

      <div class="tool-box">
        <h3>Website Screenshot</h3>
        <input id="screenshot_url" placeholder="https://example.com">
        <button onclick="takeScreenshot()">Capture</button>
        <div id="screenshot_result" class="result" style="text-align:center"></div>
      </div>

      <div class="tool-box">
        <h3>Scientific Calculator</h3>
        <input id="calc_input" placeholder="e.g. sin(45) + 2^10 + sqrt(25)">
        <button onclick="calcScientific()">Calculate</button>
        <div id="calc_result" class="result"></div>
      </div>

    </div>
  </section>

   <!-- LIFE TOOLS - FULLY RESTORED & WORKING -->
  <section id="life" class="tab-content">
    <h2 style="color:white">Life Tools</h2>
    <div class="life-grid">
      <div class="life-btn" onclick="openLife('age')">Age</div>
      <div class="life-btn" onclick="openLife('bmi')">BMI</div>
      <div class="life-btn" onclick="openLife('emi')">EMI</div>
      <div class="life-btn" onclick="openLife('unit')">Unit</div>
      <div class="life-btn" onclick="openLife('square')">Root</div>
      <div class="life-btn" onclick="openLife('percent')">Percentage</div>
      <div class="life-btn" onclick="openLife('discount')">Discount</div>
      <div class="life-btn" onclick="openLife('steps')">Steps → Cal</div>
      <div class="life-btn" onclick="openLife('stopwatch')">Stopwatch</div>
      <div class="life-btn" onclick="openLife('timer')">Timer</div>
      <div class="life-btn" onclick="openLife('sleep')">Sleep Time</div>
      <div class="life-btn" onclick="openLife('gst')">GST Calc</div>
    </div>

    <div id="age" class="tool-box life-subtab hidden">
      <h3>Age Calculator</h3>
      <input type="date" id="age_dob">
      <button onclick="calcAge()">Calculate Age</button>
      <div id="age_out" class="result"></div>
    </div>

    <div id="bmi" class="tool-box life-subtab hidden">
      <h3>BMI Calculator</h3>
      <input id="bmi_h" placeholder="Height (cm)" type="number">
      <input id="bmi_w" placeholder="Weight (kg)" type="number">
      <button onclick="calcBMI()">Calculate</button>
      <div id="bmi_out" class="result"></div>
    </div>

    <div id="emi" class="tool-box life-subtab hidden">
      <h3>EMI Calculator</h3>
      <input id="emi_p" placeholder="Loan Amount ₹" type="number">
      <input id="emi_r" placeholder="Interest Rate % (yearly)" type="number" step="0.1">
      <input id="emi_n" placeholder="Tenure (months)" type="number">
      <button onclick="calcEMI()">Calculate EMI</button>
      <div id="emi_out" class="result"></div>
    </div>

    <div id="unit" class="tool-box life-subtab hidden">
      <h3>Unit Converter</h3>
      <input id="unit_in" placeholder="Enter value" type="number">
      <select id="unit_type">
        <option value="m-cm">Meter → CM</option>
        <option value="cm-m">CM → Meter</option>
        <option value="kg-g">KG → Gram</option>
        <option value="g-kg">Gram → KG</option>
      </select>
      <button onclick="convertUnit()">Convert</button>
      <div id="unit_out" class="result"></div>
    </div>

    <div id="square" class="tool-box life-subtab hidden">
      <h3>Square / Cube Root</h3>
      <input id="root_in" placeholder="Enter number" type="number">
      <button onclick="calcRoot()">Calculate</button>
      <div id="root_out" class="result"></div>
    </div>

    <div id="percent" class="tool-box life-subtab hidden">
      <h3>Percentage Calculator</h3>
      <input id="percent_a" placeholder="Part value" type="number">
      <input id="percent_b" placeholder="Total value" type="number">
      <button onclick="calcPercent()">Calculate %</button>
      <div id="percent_out" class="result"></div>
    </div>

    <div id="discount" class="tool-box life-subtab hidden">
      <h3>Discount Calculator</h3>
      <input id="d_price" placeholder="Original Price ₹" type="number">
      <input id="d_percent" placeholder="Discount % (e.g. 20)" type="number">
      <button onclick="calcDiscount()">Calculate</button>
      <div id="discount_out" class="result"></div>
    </div>

    <div id="steps" class="tool-box life-subtab hidden">
      <h3>Steps to Calories</h3>
      <input id="steps_input" placeholder="Enter steps" type="number">
      <button onclick="stepsToCalories()">Convert</button>
      <div id="steps_result" class="result"></div>
    </div>

    <div id="stopwatch" class="tool-box life-subtab hidden">
      <h3>Stopwatch</h3>
      <div style="font-size:48px;text-align:center;margin:20px 0;font-weight:bold;color:white" id="stopwatch_display">00:00:00</div>
      <div style="text-align:center;gap:10px;display:flex;justify-content:center">
        <button onclick="startStopwatch()">Start</button>
        <button onclick="stopStopwatch()">Stop</button>
        <button onclick="resetStopwatch()">Reset</button>
      </div>
    </div>

    <div id="timer" class="tool-box life-subtab hidden">
      <h3>Countdown Timer</h3>
      <input id="timer_min" placeholder="Minutes" type="number" min="0">
      <input id="timer_sec" placeholder="Seconds" type="number" min="0" max="59">
      <button onclick="startTimer()">Start Timer</button>
      <div id="timer_display" style="font-size:42px;text-align:center;margin:20px 0;color:white">00:00</div>
    </div>

    <div id="sleep" class="tool-box life-subtab hidden">
      <h3>Sleep Cycle Calculator</h3>
      <label>Wake up time:</label>
      <input type="time" id="wake_time">
      <button onclick="suggestSleep()">Suggest Bedtime</button>
      <div id="sleep_result" class="result"></div>
    </div>

    <div id="gst" class="tool-box life-subtab hidden">
      <h3>GST Calculator</h3>
      <input id="gst_amount" placeholder="Amount (excluding GST)" type="number">
      <select id="gst_rate">
        <option value="0">0%</option>
        <option value="5">5%</option>
        <option value="12">12%</option>
        <option value="18" selected>18%</option>
        <option value="28">28%</option>
      </select>
      <button onclick="calcGST()">Calculate GST</button>
      <div id="gst_result" class="result"></div>
    </div>
  </section>

  <!-- INDIA TOOLS -->
  <section id="india" class="tab-content">
    <h2 style="color:white">India Tools</h2>
    <div class="tools-grid">

      <div class="tool-box">
        <h3>UPI QR Code Generator</h3>
        <p class="disclaimer">100% Legal • NPCI Compliant</p>
        <input id="upi_name" placeholder="Your Name / Shop Name">
        <input id="upi_id" placeholder="yourname@paytm / @oksbi">
        <input id="upi_amount" type="number" placeholder="Amount (optional)">
        <button onclick="generateUPI()">Generate QR</button>
        <div id="upi_qr" style="text-align:center;margin-top:10px"></div>
      </div>

      <div class="tool-box">
        <h3>GST Invoice Generator</h3>
        <input id="gst_name" placeholder="Customer Name">
        <input id="gst_items" placeholder="Items (comma separated)">
        <input id="gst_amount" type="number" placeholder="Total Amount (excl GST)">
        <select id="gst_rate">
          <option value="5">5%</option>
          <option value="12">12%</option>
          <option value="18" selected>18%</option>
          <option value="28">28%</option>
        </select>
        <button onclick="generateGST()">Generate Invoice</button>
        <div id="gst_invoice" class="result"></div>
      </div>

      <div class="tool-box">
        <h3>Train PNR Status (Official)</h3>
        <p class="disclaimer">Opens official IRCTC website</p>
        <input id="pnr_input" placeholder="Enter 10-digit PNR">
        <button onclick="checkOfficialPNR()">Check on IRCTC</button>
      </div>

      <div class="tool-box">
        <h3>Live Gold Rate (India)</h3>
        <button onclick="getGoldRate()">Fetch Latest Rate</button>
        <div id="gold_rate" class="result"></div>
      </div>

      <div class="tool-box">
        <h3>WhatsApp Direct Message</h3>
        <input id="wa_num" placeholder="919876543210">
        <input id="wa_msg" placeholder="Message (optional)">
        <button onclick="openWhatsApp()">Open WhatsApp</button>
      </div>

      <div class="tool-box">
        <h3>PAN Card Validator</h3>
        <input id="pan" placeholder="ABCDE1234F">
        <button onclick="validatePAN()">Validate Format</button>
        <div id="pan_result" class="result"></div>
      </div>

      <div class="tool-box">
        <h3>Live Cricket Score</h3>
        <button onclick="getCricketScore()">Get Live Score</button>
        <div id="cricket_result" class="result" style="white-space:pre-wrap"></div>
      </div>

    </div>
  </section>

  <!-- FINANCE & TAX -->
  <section id="finance" class="tab-content">
    <h2 style="color:white">Finance & Tax</h2>
    <div class="tools-grid">
      <div class="tool-box">
        <h3>Income Tax Calculator 2025-26</h3>
        <input id="income" type="number" placeholder="Annual Income">
        <select id="regime"><option>New Regime</option><option>Old Regime</option></select>
        <button onclick="calcTax()">Calculate</button>
        <div id="tax_result" class="result"></div>
      </div>
      <div class="tool-box">
        <h3>SIP Return Calculator</h3>
        <input id="sip_monthly" placeholder="Monthly Investment">
        <input id="sip_years" placeholder="Years">
        <input id="sip_rate" placeholder="Expected Return %" value="12">
        <button onclick="calcSIP()">Calculate</button>
        <div id="sip_result" class="result"></div>
      </div>
    </div>
  </section>

  <!-- FUN & VIRAL -->
  <section id="fun" class="tab-content">
    <h2 style="color:white">Fun & Viral</h2>
    <div class="tools-grid">
      <div class="tool-box">
        <h3>Love Calculator</h3>
        <input id="love1" placeholder="Your Name">
        <input id="love2" placeholder="Partner Name">
        <button onclick="loveCalc()">Check Love %</button>
        <div id="love_result" class="result" style="font-size:28px"></div>
      </div>
    </div>
  </section>

  <!-- NUMBER TOOLS -->
  <section id="number" class="tab-content">
    <h2 style="color:white">Number Tools</h2>
    <div class="tools-grid">
      <div class="tool-box">
        <h3>HCF & LCM Calculator</h3>
        <input id="hcf_a" placeholder="Number 1">
        <input id="hcf_b" placeholder="Number 2">
        <button onclick="calcHCF_LCM()">Calculate</button>
        <div id="hcf_result" class="result"></div>
      </div>

      <div class="tool-box">
        <h3>Number to Words (Indian system)</h3>
        <input id="num_words" placeholder="Enter number">
        <button onclick="numberToWords()">Convert</button>
        <div id="words_result" class="result"></div>
      </div>

      <div class="tool-box">
        <h3>Roman to Number Converter</h3>
        <input id="roman_input" placeholder="Enter Roman or Number">
        <button onclick="convertRoman()">Convert</button>
        <div id="roman_result" class="result"></div>
      </div>
    </div>
  </section>

  <!-- OPERATIONS -->
  <section id="operations" class="tab-content">
    <h2 style="color:white">Number Operations</h2>
    <div class="tools-grid">
      <div class="tool-box">
        <h3>Prime Checker</h3>
        <input id="prime_in" placeholder="Enter integer">
        <button onclick="isPrimeCheck()">Check</button>
        <div id="prime_out" class="result"></div>
      </div>

      <div class="tool-box">
        <h3>Factorial</h3>
        <input id="fact_in" placeholder="Enter integer">
        <button onclick="fact()">Find</button>
        <div id="fact_out" class="result"></div>
      </div>
    </div>
  </section>

  <!-- WEATHER -->
  <section id="weather" class="tab-content">
    <h2 style="color:white">Weather</h2>
    <div class="tools-grid">
      <div class="tool-box">
        <h3>Auto Location Weather</h3>
        <button onclick="autoWeather()">Get Weather</button>
        <div id="auto_weather_out" class="result"></div>
      </div>
      <div class="tool-box">
        <h3>City Weather</h3>
        <input id="city_in" placeholder="City name">
        <button onclick="cityWeather()">Search</button>
        <div id="city_weather_out" class="result"></div>
      </div>
    </div>
  </section>

</div>

<div class="theme-toggle" onclick="toggleTheme()">Dark Mode</div>

<script>
function $id(id){return document.getElementById(id);}

function openTab(id, btn){
  document.querySelectorAll(".tab-content").forEach(t => t.classList.remove("active"));
  $id(id)?.classList.add("active");
  document.querySelectorAll(".tab-btn").forEach(b => b.classList.remove("active-tab"));
  if(btn) btn.classList.add("active-tab");
}

/* ALL YOUR ORIGINAL FUNCTIONS - 100% COMPLETE */
function upperText(){$id('text_out').value = $id('text_in').value.toUpperCase();}
function lowerText(){$id('text_out').value = $id('text_in').value.toLowerCase();}
function removeSpaces(){$id('text_out').value = $id('text_in').value.replace(/\s+/g,' ').trim();}
function copyResult(){$id('text_out').select();document.execCommand('copy');alert('Copied to clipboard!');}

function makeQR(){
  const v = encodeURIComponent($id('qr_text').value||'');
  $id('qr_box').innerHTML = `<img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${v}">`;
}
function makeBarcode(){
  const v = $id('barcode_text').value || '123456789';
  try{JsBarcode("#barcode_svg", v, {format:"auto",displayValue:true,width:2,height:60});}
  catch(e){alert('Invalid barcode');}
}
async function getIP(){
  try{
    const r = await fetch("https://api.ipify.org?format=json");
    const d = await r.json();
    $id('ip_box').innerText = d.ip;
  }catch(e){
    $id('ip_box').innerText = 'Failed to fetch IP';
  }
}
function getDeviceInfo(){
  $id('device_box').innerText = navigator.userAgent;
}
function checkPwd(){
  const p = $id('pwd_input').value || '';
  let s=0;
  if(p.length>=8) s++;
  if(/[0-9]/.test(p)) s++;
  if(/[A-Z]/.test(p)) s++;
  if(/[@#$%^&*!]/.test(p)) s++;
  const labels = ["Very Weak","Weak","Medium","Strong","Very Strong"];
  $id('pwd_box').innerText = labels[Math.min(s,4)];
}
function shortenURL(){
  const url = $id('long_url').value.trim();
  if(!url || !url.startsWith('http')) return $id('short_url').innerText = 'Enter valid URL';
  const short = "mithun.in/" + btoa(url).substr(0,10);
  $id('short_url').innerHTML = `<a href="${url}" target="_blank">${short}</a> (Demo)`;
}
function textToPDF(){
  const text = $id('pdf_text').value || 'Hello from Mithun Tool';
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  doc.text(text, 10, 10);
  doc.save("mithun-tool.pdf");
}
let recognition = null;
function toggleVoice(){
  if(!('SpeechRecognition' in window || 'webkitSpeechRecognition' in window)){
    $id('voice_result').innerText = 'Not supported in your browser';
    return;
  }
  if(!recognition){
    const SR = window.SpeechRecognition || webkitSpeechRecognition;
    recognition = new SR();
    recognition.lang = 'en-IN';
    recognition.onresult = e => $id('voice_result').innerText = e.results[0][0].transcript;
    recognition.onerror = () => $id('voice_result').innerText = 'Error';
  }
  if(recognition.running){
    recognition.stop();
    $id('start_voice').style.display = 'block';
    $id('stop_voice').style.display = 'none';
    recognition.running = false;
  } else {
    recognition.start();
    $id('start_voice').style.display = 'none';
    $id('stop_voice').style.display = 'block';
    recognition.running = true;
  }
}
function takeScreenshot(){
  const url = $id('screenshot_url').value.trim();
  if(!url) return alert('Enter URL');
  const api = `https://api.thumbnail.ws/api/${btoa(url)}/thumbnail/get?width=800&height=600`;
  $id('screenshot_result').innerHTML = `<img src="${api}" style="max-width:100%;border-radius:8px">`;
}
function calcScientific(){
  try{
    const res = math.evaluate($id('calc_input').value);
    $id('calc_result').innerText = res;
  }catch(e){
    $id('calc_result').innerText = 'Invalid expression';
  }
function openLife(id){
  document.querySelectorAll('.life-subtab').forEach(s=>s.classList.add('hidden'));
  document.getElementById(id).classList.remove('hidden');
  document.getElementById(id).scrollIntoView({behavior:'smooth'});
}
function calcAge(){
  const dob = new Date(document.getElementById('age_dob').value);
  const diff = Date.now() - dob.getTime();
  const age = Math.floor(diff / (1000 * 60 * 60 * 24 * 365.25));
  document.getElementById('age_out').innerText = `You are ${age} years old`;
}
function calcBMI(){
  const h = parseFloat(document.getElementById('bmi_h').value)/100;
  const w = parseFloat(document.getElementById('bmi_w').value);
  if(!h||!w) return;
  const bmi = (w/(h*h)).toFixed(2);
  document.getElementById('bmi_out').innerText = `BMI: ${bmi}`;
}
function calcEMI(){
  const p = parseFloat(document.getElementById('emi_p').value);
  const r = parseFloat(document.getElementById('emi_r').value)/(12*100);
  const n = parseInt(document.getElementById('emi_n').value);
  if(!p||!r||!n) return;
  const emi = (p*r*Math.pow(1+r,n))/(Math.pow(1+r,n)-1);
  document.getElementById('emi_out').innerText = `Monthly EMI: ₹${emi.toFixed(0)}`;
}
function convertUnit(){
  const val = parseFloat(document.getElementById('unit_in').value);
  const type = document.getElementById('unit_type').value;
  let result = '';
  if(type==='m-cm') result = val*100 + ' cm';
  if(type==='cm-m') result = (val/100).toFixed(4) + ' m';
  if(type==='kg-g') result = val*1000 + ' g';
  if(type==='g-kg') result = (val/1000).toFixed(4) + ' kg';
  document.getElementById('unit_out').innerText = result;
}
function calcRoot(){
  const n = parseFloat(document.getElementById('root_in').value);
  document.getElementById('root_out').innerText = `√${n} = ${Math.sqrt(n).toFixed(4)}\n∛${n} = ${Math.cbrt(n).toFixed(4)}`;
}
function calcPercent(){
  const a = parseFloat(document.getElementById('percent_a').value);
  const b = parseFloat(document.getElementById('percent_b').value);
  document.getElementById('percent_out').innerText = `${a} is ${(a/b*100).toFixed(2)}% of ${b}`;
}
function calcDiscount(){
  const p = parseFloat(document.getElementById('d_price').value);
  const d = parseFloat(document.getElementById('d_percent').value);
  const save = p*(d/100);
  document.getElementById('discount_out').innerText = `You Save: ₹${save.toFixed(2)}\nFinal Price: ₹${(p-save).toFixed(2)}`;
}
function stepsToCalories(){
  const steps = parseInt(document.getElementById('steps_input').value) || 0;
  const cal = (steps * 0.04).toFixed(1);
  document.getElementById('steps_result').innerText = `${steps} steps ≈ ${cal} calories burned`;
}
let swInterval, swSeconds = 0;
function startStopwatch(){ if(swInterval) return; swInterval = setInterval(()=>{ swSeconds++; let h = String(Math.floor(swSeconds/3600)).padStart(2,'0'); let m = String(Math.floor((swSeconds%3600)/60)).padStart(2,'0'); let s = String(swSeconds%60).padStart(2,'0'); document.getElementById('stopwatch_display').innerText = `${h}:${m}:${s}`; },1000); }
function stopStopwatch(){ clearInterval(swInterval); swInterval=null; }
function resetStopwatch(){ stopStopwatch(); swSeconds=0; document.getElementById('stopwatch_display').innerText='00:00:00'; }
function startTimer(){
  let m = parseInt(document.getElementById('timer_min').value)||0;
  let s = parseInt(document.getElementById('timer_sec').value)||0;
  let total = m*60 + s;
  if(total<=0) return alert("Set time!");
  clearInterval(window.timerInt);
  window.timerInt = setInterval(()=>{
    total--;
    if(total<=0){ clearInterval(window.timerInt); document.getElementById('timer_display').innerText="Time Up!"; return; }
    let mm = String(Math.floor(total/60)).padStart(2,'0');
    let ss = String(total%60).padStart(2,'0');
    document.getElementById('timer_display').innerText = `${mm}:${ss}`;
  },1000);
}
function suggestSleep(){
  const time = document.getElementById('wake_time').value;
  if(!time) return;
  const [h,m] = time.split(':').map(Number);
  let mins = h*60 + m;
  let result = "Recommended bedtime:\n";
  [90,180,270,360,450].forEach(cycle=>{ 
    let bed = mins - cycle - 15; // 15 min to fall asleep
    if(bed < 0) bed += 1440;
    let bh = Math.floor(bed/60)%24; let bm = bed%60;
    result += `${bh.toString().padStart(2,'0')}:${bm.toString().padStart(2,'0')} (for ${cycle/90} cycles)\n`;
  });
  document.getElementById('sleep_result').innerText = result;
}
function calcGST(){
  const amt = parseFloat(document.getElementById('gst_amount').value);
  const rate = parseFloat(document.getElementById('gst_rate').value);
  if(isNaN(amt)) return;
  const gst = amt * rate / 100;
  document.getElementById('gst_result').innerHTML = `GST (${rate}%): ₹${gst.toFixed(2)}<br>Total Amount: ₹${(amt+gst).toFixed(2)}`;
}
/* INDIA TOOLS */
function generateUPI(){
  const name = $id('upi_name').value || "Customer";
  const upi = $id('upi_id').value;
  const amt = $id('upi_amount').value || "";
  if(!upi.includes('@')) return alert("Enter valid UPI ID");
  const url = `upi://pay?pa=${upi}&pn=${encodeURIComponent(name)}&am=${amt}&cu=INR`;
  $id('upi_qr').innerHTML = `<img src="https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodeURIComponent(url)}">`;
}
function generateGST(){
  const name=$id('gst_name').value||"Customer";
  const items=$id('gst_items').value||"Items";
  const amt=parseFloat($id('gst_amount').value)||0;
  const rate=parseFloat($id('gst_rate').value);
  const gst=amt*rate/100;
  const total=amt+gst;
  $id('gst_invoice').innerHTML = `<b>${name}</b><br>${items}<br>Amount: ₹${amt}<br>GST (${rate}%): ₹${gst.toFixed(2)}<br><b>Total: ₹${total.toFixed(2)}</b><br><button class="copy-btn" onclick="navigator.clipboard.writeText(this.parentNode.innerText)">Copy Invoice</button>`;
}
function checkOfficialPNR(){
  const pnr = $id('pnr_input').value.trim();
  if(pnr.length!==10 || isNaN(pnr)) return alert("Enter valid 10-digit PNR");
  window.open(`https://www.indianrail.gov.in/enquiry/PNR/PnrEnquiry.html?pnrNumber=${pnr}`, '_blank');
}
async function getGoldRate(){
  $id('gold_rate').innerHTML = "Fetching...";
  try{
    const res = await fetch("https://api.metals.live/v1/spot");
    const d = await res.json();
    const rate = d[0]?.price || 7200;
    $id('gold_rate').innerHTML = `24K Gold (10g): ₹${(rate*10).toFixed(0)}<br>22K Gold (10g): ₹${(rate*10*0.916).toFixed(0)}`;
  }catch(e){
    $id('gold_rate').innerHTML = "24K Gold (10g): ≈ ₹72,000 (indicative)";
  }
}
function openWhatsApp(){
  const num = $id('wa_num').value.trim();
  const msg = encodeURIComponent($id('wa_msg').value);
  if(!num) return alert("Enter number");
  window.open(`https://wa.me/${num}?text=${msg}`, '_blank');
}
function validatePAN(){
  const pan = $id('pan').value.toUpperCase();
  const regex = /^[A-Z]{5}[0-9]{4}[A-Z]{1}$/;
  $id('pan_result').innerText = regex.test(pan) ? "Valid PAN format" : "Invalid PAN format";
}
async function getCricketScore(){
  $id('cricket_result').innerHTML = "Fetching live scores...";
  try{
    const res = await fetch("https://api.cricapi.com/v1/currentMatches?apikey=YOUR_KEY&offset=0");
    const data = await res.json();
    if(data.data && data.data.length>0){
      const m = data.data[0];
      $id('cricket_result').innerHTML = `${m.name}\n${m.score || 'No score yet'}\nStatus: ${m.status}`;
    }else{
      $id('cricket_result').innerHTML = "No live matches right now";
    }
  }catch(e){
    $id('cricket_result').innerHTML = "Visit cricbuzz.com for live scores";
  }
}

/* FINANCE */
function calcTax(){
  let income = parseFloat($id('income').value)||0;
  let tax = 0;
  if(income>1500000) tax += (income-1500000)*0.3;
  else if(income>1250000) tax += (income-1250000)*0.25;
  else if(income>1000000) tax += (income-1000000)*0.2;
  else if(income>750000) tax += (income-750000)*0.15;
  else if(income>500000) tax += (income-500000)*0.1;
  else if(income>300000) tax += (income-300000)*0.05;
  $id('tax_result').innerHTML = `<b>Tax: ₹${tax.toLocaleString('en-IN')}</b><br>Take Home: ₹${(income-tax).toLocaleString('en-IN')}`;
}
function calcSIP(){
  const monthly = parseFloat($id('sip_monthly').value)||0;
  const years = parseFloat($id('sip_years').value)||0;
  const rate = parseFloat($id('sip_rate').value)/100/12;
  const months = years*12;
  const future = monthly * ((Math.pow(1+rate,months)-1)/rate) * (1+rate);
  $id('sip_result').innerHTML = `Invested: ₹${(monthly*months).toLocaleString('en-IN')}<br><b>Future Value: ₹${future.toFixed(0).toLocaleString('en-IN')}</b>`;
}
function loveCalc(){
  const n1 = $id('love1').value || "You";
  const n2 = $id('love2').value || "Partner";
  const love = 40 + (n1.length + n2.length * n2.length) % 61;
  const messages = ["Better as friends","Cute couple","Soulmates!","True love!"];
  $id('love_result').innerHTML = `${n1} + ${n2}<br><b>${love}% Match</b><br>${messages[Math.floor(love/25)]}`;
}

/* NUMBER TOOLS */
function calcHCF_LCM(){
  let a = parseInt($id('hcf_a').value);
  let b = parseInt($id('hcf_b').value);
  if(!a||!b) return $id('hcf_result').innerText='Enter two numbers';
  let x=a, y=b;
  while(y){let t=y; y=x%y; x=t;}
  const hcf = x;
  const lcm = (a*b)/hcf;
  $id('hcf_result').innerText = `HCF: ${hcf}\nLCM: ${lcm}`;
}
function numberToWords(){
  const num = parseInt($id('num_words').value);
  if(isNaN(num) || num > 999999999) return $id('words_result').innerText='0-999999999 only';
  const a = ['','One ','Two ','Three ','Four ','Five ','Six ','Seven ','Eight ','Nine ','Ten ','Eleven ','Twelve ','Thirteen ','Fourteen ','Fifteen ','Sixteen ','Seventeen ','Eighteen ','Nineteen '];
  const b = ['','','Twenty','Thirty','Forty','Fifty','Sixty','Seventy','Eighty','Ninety'];
  const f = n => n<20?a[n]:n<100?b[Math.floor(n/10)]+(n%10?a[n%10]:'')+' ':n<1000?a[Math.floor(n/100)]+'Hundred '+(n%100?f(n%100):'')+'':n<100000?f(Math.floor(n/1000))+'Thousand '+(n%1000?f(n%1000):'')+'':n<10000000?f(Math.floor(n/100000))+'Lakh '+(n%100000?f(n%100000):'')+'':f(Math.floor(n/10000000))+'Crore '+(n%10000000?f(n%10000000):'')+'';
  $id('words_result').innerText = (num===0?'Zero':f(num)) + 'Rupees Only';
}
function convertRoman(){
  const input = $id('roman_input').value.trim().toUpperCase();
  if(!input) return;
  if(!isNaN(input)){
    let n = parseInt(input);
    const v = [1000,900,500,400,100,90,50,40,10,9,5,4,1];
    const s = ["M","CM","D","CD","C","XC","L","XL","X","IX","V","IV","I"];
    let res = '';
    for(let i=0;i<v.length;i++) while(n>=v[i]){res+=s[i]; n-=v[i];}
    $id('roman_result').innerText = res;
  } else {
    const map = {I:1,V:5,X:10,L:50,C:100,D:500,M:1000};
    let num = 0;
    for(let i=0;i<input.length;i++){
      if(map[input[i]] < map[input[i+1] || '']) num -= map[input[i]];
      else num += map[input[i]];
    }
    $id('roman_result').innerText = num;
  }
}

/* OPERATIONS */
function isPrimeCheck(){
  const n = parseInt($id('prime_in').value);
  if(isNaN(n)||n<2){$id('prime_out').innerText='Not prime';return;}
  for(let i=2;i*i<=n;i++) if(n%i===0){$id('prime_out').innerText='Not prime';return;}
  $id('prime_out').innerText='Prime Number';
}
function fact(){
  let n = parseInt($id('fact_in').value);
  if(isNaN(n)||n<0){$id('fact_out').innerText='Enter non-negative';return;}
  let f=1;
  for(let i=2;i<=n;i++) f*=i;
  $id('fact_out').innerText = f;
}

/* WEATHER */
async function cityWeather(){
  const c = $id('city_in').value.trim();
  if(!c) return;
  try{
    const r = await fetch(`https://wttr.in/${encodeURIComponent(c)}?format=%l:+%t+|+%C`);
    const t = await r.text();
    $id('city_weather_out').innerText = t;
  }catch(e){
    $id('city_weather_out').innerText = 'Error';
  }
}
function autoWeather(){
  if(!navigator.geolocation) return $id('auto_weather_out').innerText='Not supported';
  navigator.geolocation.getCurrentPosition(async pos=>{
    try{
      const r = await fetch(`https://wttr.in/@${pos.coords.latitude.toFixed(4)},${pos.coords.longitude.toFixed(4)}?format=%l:+%t+|+%C`);
      const t = await r.text();
      $id('auto_weather_out').innerText = t;
    }catch(e){
      $id('auto_weather_out').innerText = 'Error';
    }
  }, ()=>$id('auto_weather_out').innerText='Permission denied');
}

/* THEME */
function toggleTheme(){
  document.body.dataset.theme = document.body.dataset.theme==="dark" ? "" : "dark";
  localStorage.setItem('theme', document.body.dataset.theme||"light");
}
if(localStorage.getItem('theme')==="dark") document.body.dataset.theme="dark";

/* INIT */
document.addEventListener('DOMContentLoaded', function(){
  document.querySelectorAll('.life-subtab').forEach(s=>s.classList.add('hidden'));
  openTab('home');
});
</script>

</body>
</html>
