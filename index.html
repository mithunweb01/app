<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mithun Multi Tool App</title>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #f0f2f5;
}

header {
  background: #4a4aff;
  color: white;
  padding: 15px;
  text-align: center;
  font-size: 22px;
  font-weight: bold;
}

nav {
  display: flex;
  flex-wrap: wrap;
  background: #222;
}

nav button {
  flex: 1;
  padding: 12px;
  border: none;
  background: #222;
  color: white;
  font-size: 15px;
  cursor: pointer;
  border-right: 1px solid #333;
}

nav button:hover {
  background: #444;
}

.section {
  display: none;
  padding: 20px;
}

.active {
  display: block;
}

.tool-btn {
  display: block;
  width: 100%;
  margin: 10px 0;
  padding: 12px;
  background: #4a4aff;
  color: white;
  border: none;
  font-size: 16px;
  border-radius: 8px;
  cursor: pointer;
}

.result-box {
  background: white;
  padding: 15px;
  border-radius: 10px;
  margin-top: 15px;
  box-shadow: 0 3px 6px rgba(0,0,0,0.2);
}

input, select {
  padding: 8px;
  margin: 5px 0;
  width: 90%;
}
</style>
</head>

<body>

<header>Mithun Multi Tool App</header>

<nav>
  <button onclick="openTab('home')">Home</button>
  <button onclick="openTab('smart')">Smart Tools</button>
  <button onclick="openTab('life')">Life Tools</button>
  <button onclick="openTab('weather')">Weather</button>
  <button onclick="openTab('capital')">Capital Finder</button>
</nav>

<!-- HOME -->
<div id="home" class="section active">
  <h2>Welcome</h2>
  <p>Select a tab to begin.</p>
</div>

<!-- SMART TOOLS -->
<div id="smart" class="section">
  <h2>Smart Tools</h2>
  <button class="tool-btn" onclick="openInner('qrcode')">QR Code Generator</button>
  <button class="tool-btn" onclick="openInner('barcode')">Barcode Generator</button>
  <button class="tool-btn" onclick="openInner('ip')">IP Finder</button>
  <button class="tool-btn" onclick="openInner('device')">Device Info</button>
  <button class="tool-btn" onclick="openInner('passmeter')">Password Strength Meter</button>
  <div id="smartContent"></div>
</div>

<!-- LIFE TOOLS -->
<div id="life" class="section">
  <h2>Life Tools</h2>
  <button class="tool-btn" onclick="openLife('sqrt')">Square & Cube Root</button>
  <button class="tool-btn" onclick="openLife('percent')">Percentage Finder</button>
  <button class="tool-btn" onclick="openLife('discount')">Discount Calculator</button>
  <button class="tool-btn" onclick="openLife('area')">Area & Volume Calculator</button>
  <div id="lifeContent"></div>
</div>

<!-- WEATHER -->
<div id="weather" class="section">
  <h2>Weather Forecast</h2>
  <button class="tool-btn" onclick="getAutoWeather()">Get Weather by Location</button>

  <h3>Or Enter City</h3>
  <input id="weatherCity" placeholder="Enter city name">
  <button class="tool-btn" onclick="getWeatherByCity()">Get Weather</button>

  <div id="weatherResult" class="result-box"></div>
</div>

<!-- CAPITAL FINDER -->
<div id="capital" class="section">
  <h2>Capital Finder</h2>
  <input id="countryInput" placeholder="Enter country name">
  <button class="tool-btn" onclick="getCapital()">Find Capital</button>
  <div id="capitalResult" class="result-box"></div>
</div>

<script>
/* ---------------- TAB SYSTEM ---------------- */
function openTab(id) {
  document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

/* ---------------- SMART TOOLS ---------------- */
function openInner(tool) {
  let box = document.getElementById("smartContent");

  if (tool === "qrcode") {
    box.innerHTML = `
      <h3>QR Code Generator</h3>
      <input id="qrText" placeholder="Enter text">
      <button class="tool-btn" onclick="makeQR()">Generate</button>
      <div id="qrResult"></div>`;
  }

  if (tool === "barcode") {
    box.innerHTML = `
      <h3>Barcode Generator</h3>
      <input id="barText" placeholder="Enter number">
      <button class="tool-btn" onclick="makeBarcode()">Generate</button>
      <svg id="barcode"></svg>`;
  }

  if (tool === "ip") {
    fetch("https://api.ipify.org?format=json")
      .then(r => r.json())
      .then(d => {
        box.innerHTML = `<h3>Your IP Address</h3><div class="result-box">${d.ip}</div>`;
      });
  }

  if (tool === "device") {
    box.innerHTML = `
      <h3>Device Info</h3>
      <div class="result-box">
        <b>User Agent:</b> ${navigator.userAgent}<br>
        <b>Platform:</b> ${navigator.platform}<br>
        <b>Language:</b> ${navigator.language}
      </div>`;
  }

  if (tool === "passmeter") {
    box.innerHTML = `
      <h3>Password Strength Meter</h3>
      <input id="passInput" oninput="checkPass()" placeholder="Enter password">
      <div id="passStrength" class="result-box"></div>`;
  }
}

function makeQR() {
  let text = document.getElementById("qrText").value;
  document.getElementById("qrResult").innerHTML =
    `<img src="https://api.qrserver.com/v1/create-qr-code/?size=200x200&data=${text}">`;
}

function makeBarcode() {
  let text = document.getElementById("barText").value;
  JsBarcode("#barcode", text);
}

function checkPass() {
  let p = document.getElementById("passInput").value;
  let s = "Weak";
  if (p.length > 6) s = "Medium";
  if (p.length > 10 && /[0-9]/.test(p) && /[A-Z]/.test(p)) s = "Strong";
  document.getElementById("passStrength").innerHTML = "Strength: " + s;
}

/* ---------------- LIFE TOOLS ---------------- */
function openLife(tool) {
  let box = document.getElementById("lifeContent");

  if (tool === "sqrt") {
    box.innerHTML = `
      <h3>Square & Cube Root</h3>
      <input id="numRoot" placeholder="Enter number">
      <button class="tool-btn" onclick="calcRoot()">Calculate</button>
      <div id="rootResult" class="result-box"></div>`;
  }

  if (tool === "percent") {
    box.innerHTML = `
      <h3>Percentage Finder</h3>
      <input id="percentNum" placeholder="Number">
      <input id="percentPct" placeholder="Percentage">
      <button class="tool-btn" onclick="calcPercent()">Calculate</button>
      <div id="percentResult" class="result-box"></div>`;
  }

  if (tool === "discount") {
    box.innerHTML = `
      <h3>Discount Calculator</h3>
      <input id="price" placeholder="Price">
      <input id="disc" placeholder="Discount %">
      <button class="tool-btn" onclick="calcDiscount()">Calculate</button>
      <div id="discResult" class="result-box"></div>`;
  }

  if (tool === "area") {
    box.innerHTML = `
      <h3>Area of Rectangle</h3>
      <input id="l" placeholder="Length">
      <input id="b" placeholder="Breadth">
      <button class="tool-btn" onclick="calcArea()">Calculate</button>
      <div id="areaResult" class="result-box"></div>`;
  }
}

function calcRoot() {
  let n = document.getElementById("numRoot").value;
  document.getElementById("rootResult").innerHTML =
    `Square Root: ${Math.sqrt(n)}<br>Cube Root: ${Math.cbrt(n)}`;
}

function calcPercent() {
  let n = document.getElementById("percentNum").value;
  let p = document.getElementById("percentPct").value;
  document.getElementById("percentResult").innerHTML =
    (n * p / 100).toFixed(2);
}

function calcDiscount() {
  let p = document.getElementById("price").value;
  let d = document.getElementById("disc").value;
  let final = p - (p * d / 100);
  document.getElementById("discResult").innerHTML = "Final Price: " + final;
}

function calcArea() {
  let L = document.getElementById("l").value;
  let B = document.getElementById("b").value;
  document.getElementById("areaResult").innerHTML =
    "Area: " + (L * B);
}

/* ---------------- WEATHER ---------------- */
const weatherKey = "b66a33257021cbcf5b021b6fc56efddb"; // YOUR FREE API KEY

function getWeatherByCity() {
  let city = document.getElementById("weatherCity").value;
  fetchWeather(city);
}

function getAutoWeather() {
  navigator.geolocation.getCurrentPosition(pos => {
    let lat = pos.coords.latitude;
    let lon = pos.coords.longitude;
    fetchWeather("", lat, lon);
  });
}

function fetchWeather(city, lat = "", lon = "") {
  let url =
    city
    ? `https://api.openweathermap.org/data/2.5/weather?q=${city}&appid=${weatherKey}&units=metric`
    : `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${lon}&appid=${weatherKey}&units=metric`;

  fetch(url)
    .then(r => r.json())
    .then(d => {
      document.getElementById("weatherResult").innerHTML = `
        <b>${d.name}</b><br>
        Temperature: ${d.main.temp}Â°C<br>
        Humidity: ${d.main.humidity}%<br>
        Weather: ${d.weather[0].description}
      `;
    });
}

/* ---------------- CAPITAL FINDER ---------------- */
function levenshtein(a, b) {
  const m = [];
  for (let i = 0; i <= a.length; i++) {
    m[i] = [i];
    for (let j = 1; j <= b.length; j++) {
      if (i === 0) m[0][j] = j;
      else {
        m[i][j] = Math.min(
          m[i-1][j] + 1,
          m[i][j-1] + 1,
          m[i-1][j-1] + (a[i-1] === b[j-1] ? 0 : 1)
        );
      }
    }
  }
  return m[a.length][b.length];
}

function fuzzyMatch(input, list) {
  input = input.toLowerCase();
  let best = "";
  let bestScore = 999;
  for (let c of list) {
    let score = levenshtein(input, c.toLowerCase());
    if (score < bestScore) {
      bestScore = score;
      best = c;
    }
  }
  return best;
}

async function getCapital() {
  let input = document.getElementById("countryInput").value;

  let all = await fetch("https://restcountries.com/v3.1/all").then(r => r.json());
  let names = all.map(x => x.name.common);

  let best = fuzzyMatch(input, names);

  let info = await fetch(`https://restcountries.com/v3.1/name/${best}?fullText=true`)
    .then(r => r.json());

  let c = info[0];

  let wiki = await fetch(`https://en.wikipedia.org/api/rest_v1/page/summary/${best}`)
    .then(r => r.json());

  document.getElementById("capitalResult").innerHTML = `
    <h3>${best}</h3>
    <img src="${c.flags.png}" width="120"><br><br>
    <b>Capital:</b> ${c.capital}<br>
    <b>Region:</b> ${c.region}<br>
    <b>Population:</b> ${c.population.toLocaleString()}<br>
    <b>Languages:</b> ${Object.values(c.languages || {}).join(", ")}<br>
    <b>Currencies:</b> ${Object.values(c.currencies || {}).map(x => x.name).join(", ")}<br>
    <hr>
    <b>About ${best}:</b><br>
    ${wiki.extract || "No summary available."}
  `;
}
</script>

<script src="https://cdn.jsdelivr.net/jsbarcode/3.11.5/JsBarcode.all.min.js"></script>

</body>
</html>
